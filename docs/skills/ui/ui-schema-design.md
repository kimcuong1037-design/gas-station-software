# Skill: UI Schema 设计 (UI Schema Design)

## 元信息

- **Skill ID:** `ui-schema-design`
- **所属 Agent:** UI 设计 Agent (UI Designer)
- **输入：**
  - User Story 文档（`docs/features/<domain>/<module>/user-stories.md`，由 `user-story-writing` Skill 产出）
  - UI/UX 设计规范（`docs/STANDARDS.md` §4）
  - Ant Design 组件库参考
- **输出：**
  - UI Schema 文档（存放于 `docs/features/<domain>/<module>/ui-schema.md`）
- **依赖：** `user-story-writing` Skill 的产出

---

## 流程定义

### 步骤 1: 确认输入完整性

检查前置条件：
- User Story 文档已存在且状态为"已确认"
- 所有 [MVP] Story 的验收标准已明确
- UI/UX 设计规范（STANDARDS.md §4）已阅读

如果前置条件不满足，停止并报告缺失项。

### 步骤 2: 页面规划

根据 User Story 确定需要的页面：

**页面类型分类：**

| 类型 | 说明 | 典型 Ant Design 组件 |
|------|------|---------------------|
| 列表页 | 数据表格 + 筛选/搜索 + 操作按钮 | Table, Input.Search, Select, Button, Space |
| 详情页 | 只读数据展示，通常为抽屉或独立页面 | Descriptions, Drawer, Card, Tabs |
| 表单页 | 新增/编辑数据，弹窗或独立页面 | Form, Input, Select, DatePicker, Modal |
| 看板页 | KPI 卡片 + 图表 + 状态概览 | Card, Statistic, Row/Col, ECharts |
| 报表页 | 图表 + 数据表格 + 导出 | ECharts, Table, Button(导出) |

**页面命名规范：**
- 列表页：`<Entity>List`（如 `StationList`）
- 详情页：`<Entity>Detail`（如 `StationDetail`）
- 表单页：`<Entity>Form`（如 `StationForm`）
- 看板页：`<Entity>Dashboard`（如 `EquipmentDashboard`）

### 步骤 3: 定义页面结构

为每个页面定义结构，包含：

**3.1 页面头部**
- 面包屑路径
- 页面标题
- 操作按钮（新增、导出等）

**3.2 筛选区域（列表页）**
- 筛选字段列表（字段名、组件类型、数据源）
- 查询/重置按钮
- 高级筛选（展开/收起）

**3.3 主内容区域**
- 数据表格列定义（列名、字段、宽度、对齐、渲染方式）
- 或表单字段定义（字段名、组件类型、校验规则、默认值）
- 或看板卡片布局（卡片内容、布局方式）

**3.4 操作区域**
- 行操作（查看、编辑、删除等）
- 批量操作
- 分页配置

### 步骤 4: 定义交互行为

为每个页面定义关键交互：

| 交互类型 | 说明 |
|---------|------|
| 页面跳转 | 点击后跳转到哪个页面，携带什么参数 |
| 弹窗/抽屉 | 触发条件、内容、确认/取消行为 |
| 表单提交 | 校验规则、提交后行为（跳转/刷新/提示） |
| 数据刷新 | 何时自动刷新、手动刷新按钮 |
| 状态变更 | 状态流转操作（如审批、启用/禁用） |
| 确认操作 | 需要二次确认的危险操作 |

### 步骤 5: 定义数据字段

为每个页面列出所需的数据字段：
- 字段名（中文 + 英文代码名）
- 数据类型
- 是否必填
- 显示格式（日期格式、金额格式、枚举值映射等）
- 数据来源（模拟数据中的对应字段）

### 步骤 6: 页面间导航关系

描述页面之间的导航关系：
- 从哪个页面可以到达当前页面
- 当前页面可以跳转到哪些页面
- 侧边栏菜单结构

### 步骤 7: 输出 UI Schema 文档

按输出格式生成文档，存放到指定路径。

---

## Prompt 模板

```
你是 UI 设计 Agent，负责为加气站运营管理系统的指定模块设计 UI Schema。

## 任务
为模块【{{MODULE_NAME}}】设计 UI Schema。

## 输入文件
- User Story 文档：docs/features/{{DOMAIN}}/{{MODULE}}/user-stories.md
- UI/UX 设计规范：docs/STANDARDS.md §4
- 组件库：Ant Design (antd) v5

## 执行步骤
请严格按照 docs/skills/ui/ui-schema-design.md 中定义的步骤 1-7 执行。

## 关键要求
1. 所有页面必须遵循 STANDARDS.md §4 的布局结构
2. 优先使用 Ant Design 标准组件，避免自定义组件
3. 列表页必须包含筛选/搜索功能
4. 表格列定义必须完整（列名、字段、宽度、渲染方式）
5. 表单必须定义校验规则
6. 交互行为必须明确（点击后发生什么）
7. 字段命名遵循 STANDARDS.md §1 术语表

## 输出
将结果写入：docs/features/{{DOMAIN}}/{{MODULE}}/ui-schema.md
格式遵循本 Skill 文件中的"输出格式"规范。
```

---

## 输出格式

```markdown
# {{MODULE_NAME}} — UI Schema

**模块：** {{MODULE_NAME}}
**基于：** user-stories.md v{{VERSION}}
**设计日期：** {{DATE}}
**状态：** 待确认 / 已确认

---

## 1. 页面清单

| # | 页面名称 | 类型 | 路由 | 对应 Story |
|---|---------|------|------|-----------|
| P01 | {{页面名}} | 列表页 | /operations/station | US-001, US-002 |
| P02 | {{页面名}} | 详情页 | /operations/station/:id | US-003 |
| ... | | | | |

---

## 2. 侧边栏菜单结构

```text
{{一级菜单名}}
├── {{二级菜单名}} → P01
├── {{二级菜单名}} → P02
└── {{二级菜单名}} → P03
```

---

## 3. 页面详细设计

### P01: {{页面名称}}（列表页）

**路由：** `{{route}}`
**对应 Story：** US-001, US-002
**权限：** {{角色列表}}

#### 页面头部

- **面包屑：** 首页 / {{一级}} / {{二级}}
- **标题：** {{页面标题}}
- **操作按钮：** [新增{{实体}}] [导出]

#### 筛选区域

| 字段 | 组件 | 数据源 | 默认值 |
|------|------|--------|--------|
| {{字段名}} | Input.Search | - | - |
| {{字段名}} | Select | {{枚举/API}} | 全部 |
| {{字段名}} | DatePicker.RangePicker | - | 最近7天 |

#### 数据表格

| 列名 | 字段 | 宽度 | 对齐 | 渲染 |
|------|------|------|------|------|
| {{列名}} | {{field}} | 120px | left | 文本 |
| {{列名}} | {{field}} | 80px | center | Tag(颜色映射) |
| {{列名}} | {{field}} | 100px | right | 金额(¥0.00) |
| 操作 | - | 150px | center | [查看] [编辑] [删除] |

**分页：** 默认 20 条/页，可选 10/20/50/100

#### 交互行为

| 触发 | 行为 | 说明 |
|------|------|------|
| 点击 [新增] | 打开 Modal/跳转 P03 | 新增表单 |
| 点击 [查看] | 打开 Drawer/跳转 P02 | 只读详情 |
| 点击 [编辑] | 打开 Modal/跳转 P03 | 编辑表单，预填数据 |
| 点击 [删除] | Popconfirm 确认 | 确认后删除，刷新列表 |

---

### P02: {{页面名称}}（详情页）

（类似结构，根据页面类型调整）

---

### P03: {{页面名称}}（表单页）

**路由：** `{{route}}`
**对应 Story：** US-005

#### 表单字段

| 字段 | 标签 | 组件 | 必填 | 校验规则 | 默认值 |
|------|------|------|------|---------|--------|
| {{field}} | {{标签}} | Input | 是 | 最大50字符 | - |
| {{field}} | {{标签}} | Select | 是 | - | {{默认}} |
| {{field}} | {{标签}} | InputNumber | 否 | min:0, max:999 | 0 |

#### 表单行为

| 触发 | 行为 |
|------|------|
| 提交 | 校验 → 保存 → 提示成功 → 返回列表/关闭弹窗 |
| 取消 | 确认放弃 → 返回列表/关闭弹窗 |

---

## 4. 页面导航关系

```text
{{页面A}} --[点击查看]--> {{页面B}}
{{页面A}} --[点击新增]--> {{页面C}}
{{页面B}} --[点击编辑]--> {{页面C}}
{{页面B}} --[返回]--> {{页面A}}
```
```

---

## 检查清单

- [ ] 所有 [MVP] Story 都有对应的页面设计
- [ ] 所有页面都有明确的路由定义
- [ ] 列表页包含筛选/搜索功能
- [ ] 表格列定义完整（列名、字段、宽度、渲染方式）
- [ ] 表单字段包含校验规则
- [ ] 交互行为明确（每个按钮点击后发生什么）
- [ ] 页面间导航关系清晰
- [ ] 组件选择优先使用 Ant Design 标准组件
- [ ] 字段命名与 STANDARDS.md 术语表一致
- [ ] 侧边栏菜单结构已定义

---

## 附录: Ant Design 常用组件速查

| 场景 | 推荐组件 |
|------|---------|
| 数据表格 | `Table` (带 sorter, filter) |
| 搜索输入 | `Input.Search` |
| 下拉选择 | `Select` (支持搜索、多选) |
| 日期选择 | `DatePicker`, `DatePicker.RangePicker` |
| 表单 | `Form`, `Form.Item` |
| 数字输入 | `InputNumber` |
| 开关 | `Switch` |
| 标签 | `Tag` (颜色映射状态) |
| 徽标 | `Badge` (状态指示) |
| 统计数值 | `Statistic` |
| 卡片 | `Card` |
| 描述列表 | `Descriptions` |
| 抽屉 | `Drawer` |
| 弹窗 | `Modal` |
| 确认气泡 | `Popconfirm` |
| 消息提示 | `message.success/error/warning` |
| 面包屑 | `Breadcrumb` |
| 标签页 | `Tabs` |
| 步骤条 | `Steps` |
| 上传 | `Upload` (图片/文件) |
| 图表 | ECharts (非 antd，独立集成) |
